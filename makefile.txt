# å¹¾ä½•å­¦çš„è¨€èªãƒ¢ãƒ‡ãƒ«ç ”ç©¶ï¼šå®Œå…¨è‡ªå‹•åŒ–Makefile
# ä½¿ç”¨æ–¹æ³•: make do

.PHONY: do setup data train evaluate paper clean help

# ãƒ¡ã‚¤ãƒ³ã‚¿ãƒ¼ã‚²ãƒƒãƒˆï¼šå…¨å·¥ç¨‹ã®è‡ªå‹•å®Ÿè¡Œ
do: setup data train evaluate paper
	@echo "ğŸ‰ ç ”ç©¶ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Œäº†ï¼"
	@echo "ğŸ“„ è«–æ–‡: output/è«–æ–‡.pdf"
	@echo "ğŸ“Š çµæœ: results/experiment_results.json"

# ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
setup:
	@echo "ğŸ”§ ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ä¸­..."
	@pip install torch transformers scipy matplotlib seaborn pandas datasets pytest scikit-learn
	@mkdir -p data results output src
	@echo "âœ… ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Œäº†"

# ãƒ‡ãƒ¼ã‚¿æº–å‚™
data:
	@echo "ğŸ“Š ãƒ‡ãƒ¼ã‚¿æº–å‚™ä¸­..."
	@python ãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³.py
	@echo "âœ… ãƒ‡ãƒ¼ã‚¿æº–å‚™å®Œäº†"

# ãƒ¢ãƒ‡ãƒ«è¨“ç·´
train:
	@echo "ğŸš€ ãƒ¢ãƒ‡ãƒ«è¨“ç·´ä¸­..."
	@python -c "import å®Ÿé¨“ã‚³ãƒ¼ãƒ‰; å®Ÿé¨“ã‚³ãƒ¼ãƒ‰.run_training()"
	@echo "âœ… è¨“ç·´å®Œäº†"

# è©•ä¾¡å®Ÿè¡Œ
evaluate:
	@echo "ğŸ“ˆ è©•ä¾¡å®Ÿè¡Œä¸­..."
	@python -c "import å®Ÿé¨“ã‚³ãƒ¼ãƒ‰; å®Ÿé¨“ã‚³ãƒ¼ãƒ‰.run_evaluation()"
	@echo "âœ… è©•ä¾¡å®Œäº†"

# è«–æ–‡ç”Ÿæˆ
paper:
	@echo "ğŸ“ è«–æ–‡ç”Ÿæˆä¸­..."
	@python -c "import å®Ÿé¨“ã‚³ãƒ¼ãƒ‰; å®Ÿé¨“ã‚³ãƒ¼ãƒ‰.generate_paper()"
	@pdflatex -output-directory=output output/è«–æ–‡.tex || echo "âš ï¸ PDFç”Ÿæˆå¤±æ•—ï¼šæ‰‹å‹•ã§pdflatexå®Ÿè¡Œã—ã¦ãã ã•ã„"
	@echo "âœ… è«–æ–‡ç”Ÿæˆå®Œäº†"

# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
test:
	@echo "ğŸ§ª ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­..."
	@python ãƒ†ã‚¹ãƒˆé§†å‹•å®Ÿè£….py
	@pytest -v ãƒ†ã‚¹ãƒˆé§†å‹•å®Ÿè£….py::TestMetricTensor
	@echo "âœ… ãƒ†ã‚¹ãƒˆå®Œäº†"

# ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
clean:
	@echo "ğŸ§¹ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ä¸­..."
	@rm -rf data/processed results output
	@rm -f *.pyc __pycache__
	@echo "âœ… ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Œäº†"

# ãƒ˜ãƒ«ãƒ—
help:
	@echo "å¹¾ä½•å­¦çš„è¨€èªãƒ¢ãƒ‡ãƒ«ç ”ç©¶è‡ªå‹•åŒ–ã‚·ã‚¹ãƒ†ãƒ "
	@echo ""
	@echo "ä½¿ç”¨æ–¹æ³•:"
	@echo "  make do      - å…¨å·¥ç¨‹ã‚’è‡ªå‹•å®Ÿè¡Œï¼ˆæ¨å¥¨ï¼‰"
	@echo "  make setup   - ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã®ã¿"
	@echo "  make data    - ãƒ‡ãƒ¼ã‚¿æº–å‚™ã®ã¿"
	@echo "  make train   - è¨“ç·´ã®ã¿"
	@echo "  make evaluate- è©•ä¾¡ã®ã¿"
	@echo "  make paper   - è«–æ–‡ç”Ÿæˆã®ã¿"
	@echo "  make test    - ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ"
	@echo "  make clean   - ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤"
	@echo "  make help    - ã“ã®ãƒ˜ãƒ«ãƒ—"
